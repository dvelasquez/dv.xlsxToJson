!function(n){var t=angular.module("dv.xlsxToJson",[]),r=function(n,t){var r=function(n,t,r){return function(){r.$apply(function(){t.resolve(n.result)})}},e=function(n,t,r){return function(){r.$apply(function(){t.reject(n.result)})}},a=function(n,t){return function(n){t.$broadcast("xtjProgress",{total:n.total,loaded:n.loaded})}},o=function(n,t){var o=new FileReader;return o.onload=r(o,n,t),o.onerror=e(o,n,t),o.onprogress=a(o,t),o},i=function(t,r){var e=n.defer(),a=o(e,r);return a.readAsDataURL(t),e.promise};return{readAsDataUrl:i}};t.factory("xtjReader",["$q","$log",r]);var e=function(n){return{restrict:"EA",template:"<input type='file' />",replace:!0,link:function(t,r,e){var a=n(e.xtj),o=(a.assign,n(e.onChange),function(){t.$apply(function(){var e=n(r.attr("xtj")),a=e.assign,o=n(r.attr("on-change"));alasql("SELECT * FROM FILE(?,{headers:true})",[window.event],function(n){t.xlsxAsJson=n}),a(t,r[0].files[0]),o(t)})});r.bind("change",o)}}};t.directive("xtj",["$parse",e])}();